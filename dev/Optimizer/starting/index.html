<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solving simple example: an artificial neural network with EAGO · EAGO.jl: Easy Advanced Global Optimization</title><link rel="canonical" href="https://PSORLab.github.io/EAGO.jl/stable/Optimizer/starting/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">EAGO.jl: Easy Advanced Global Optimization</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">McCormick Operator Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../McCormick/overview/">Overview</a></li><li><a class="tocitem" href="../../McCormick/usage/">Basic Usage</a></li><li><a class="tocitem" href="../../McCormick/operators/"><strong>Currently supported operators</strong></a></li><li><a class="tocitem" href="../../McCormick/type/"><strong>Types</strong></a></li><li><a class="tocitem" href="../../McCormick/implicit/">Relaxation of Implicit Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Global Optimizer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Solving simple example: an artificial neural network with EAGO</a></li><li><a class="tocitem" href="../optimizer/">EAGO Optimizer</a></li><li><a class="tocitem" href="../bnb_back/">EAGO&#39;s Branch and Bound Routine</a></li><li><a class="tocitem" href="../relax_back/">Relaxation Backend</a></li><li><a class="tocitem" href="../domain_reduction/">Domain Reduction</a></li><li><a class="tocitem" href="../high_performance/">High-Performance Configuration</a></li><li><a class="tocitem" href="../udf_utilities/">User-Define Functions and DAG Utilities</a></li></ul></li><li><a class="tocitem" href="../../SemiInfinite/semiinfinite/">Semi-Infinite Programming</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Contributing to EAGO</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Dev/contributing/">How to Contribute</a></li><li><a class="tocitem" href="../../Dev/future/">Future Work</a></li></ul></li><li><a class="tocitem" href="../../ref/">References</a></li><li><a class="tocitem" href="../../cite/">Citing EAGO</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Global Optimizer</a></li><li class="is-active"><a href>Solving simple example: an artificial neural network with EAGO</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solving simple example: an artificial neural network with EAGO</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PSORLab/EAGO.jl/blob/master/docs/src/Optimizer/starting.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Solving-simple-example:-an-artificial-neural-network-with-EAGO"><a class="docs-heading-anchor" href="#Solving-simple-example:-an-artificial-neural-network-with-EAGO">Solving simple example: an artificial neural network with EAGO</a><a id="Solving-simple-example:-an-artificial-neural-network-with-EAGO-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-simple-example:-an-artificial-neural-network-with-EAGO" title="Permalink"></a></h1><p><a href="https://psor.uconn.edu/person/matthew-wilhelm/">Matthew Wilhelm</a>   Department of Chemical and Biomolecular Engineering, University of Connecticut</p><p>In [1,2], a surrogate ANN model of bioreactor productivity was constructed by fitting results from computationally expensive CFD simulations. The author then optimized this surrogate model to obtain ideal processing conditions. This optimization problem is given by:</p><h3 id="Input-parameters"><a class="docs-heading-anchor" href="#Input-parameters">Input parameters</a><a id="Input-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Input-parameters" title="Permalink"></a></h3><p>In the first block, we input parameters values supplied in the paper for <span>$W$</span>, <span>$B$</span>, <span>$D$</span>, and <span>$X$</span> into Julia as simple array objects.</p><pre><code class="language-julia">using JuMP, EAGO

# Box constraints for input variables
xLBD = [0.623   0.093   0.259   6.56   1114   0.013   0.127   0.004]
xUBD = [5.89    0.5     1.0     90     25000  0.149   0.889   0.049]

# Weights associated with the hidden layer
W = [ 0.54  -1.97  0.09  -2.14  1.01  -0.58  0.45  0.26;
     -0.81  -0.74  0.63  -1.60 -0.56  -1.05  1.23  0.93;
     -0.11  -0.38 -1.19   0.43  1.21   2.78 -0.06  0.40]

# Weights associated with the output layer
D = [-0.91 0.11 0.52]

# Bias associated with the hidden layer
B1 = [-2.698 0.012 2.926]

# Bias associated with the output layer
B2 = -0.46</code></pre><h3 id="Construct-the-JuMP-model-and-optimize"><a class="docs-heading-anchor" href="#Construct-the-JuMP-model-and-optimize">Construct the JuMP model and optimize</a><a id="Construct-the-JuMP-model-and-optimize-1"></a><a class="docs-heading-anchor-permalink" href="#Construct-the-JuMP-model-and-optimize" title="Permalink"></a></h3><p>We now formulate the problem using standard JuMP[3] syntax and optimize it. Note that we are forming an NLexpression object to handle the summation term to keep the code visually simple but this could be placed directly in the JuMP expressions instead.</p><pre><code class="language-julia"># Model construction
model = Model(optimizer_with_attributes(EAGO.Optimizer, &quot;absolute_tolerance&quot; =&gt; 0.001))
@variable(model, xLBD[i] &lt;= x[i=1:8] &lt;= xUBD[i])
@NLexpression(model, prop[i=1:3], B1[i] + sum(W[i,j]*x[i] for j in 1:8))
@NLobjective(model, Max, B2 + sum(D[i]*(2/(1+exp(-2*prop[i]))) for i=1:3))

# Solves the model
optimize!(model)</code></pre><h3 id="Retrieve-results"><a class="docs-heading-anchor" href="#Retrieve-results">Retrieve results</a><a id="Retrieve-results-1"></a><a class="docs-heading-anchor-permalink" href="#Retrieve-results" title="Permalink"></a></h3><p>We then recover the objective value, the solution value, and termination status codes using standard JuMP syntax.</p><pre><code class="language-julia"># Access calculated values
fval = JuMP.objective_value(model)
xsol = JuMP.value.(x)
status_term = JuMP.termination_status(model)
status_prim = JuMP.primal_status(model)

println(&quot;EAGO terminated with a status of $status_term and a result code of $status_prim&quot;)
println(&quot;The optimal value is: $fval, the solution found is $xsol.&quot;)</code></pre><h3 id="Reference:"><a class="docs-heading-anchor" href="#Reference:">Reference:</a><a id="Reference:-1"></a><a class="docs-heading-anchor-permalink" href="#Reference:" title="Permalink"></a></h3><ol><li>J. D. Smith, A. A. Neto, S. Cremaschi, and D. W. Crunkleton, CFD-based optimization of a flooded bed algae bioreactor, <em>Industrial &amp; Engineering Chemistry Research</em>, 52 (2012), pp. 7181–7188</li><li>A. M. Schweidtmann and A. Mitsos. Global Deterministic Optimization with Artificial Neural Networks Embedded <a href="https://arxiv.org/pdf/1801.07114.pdf">https://arxiv.org/pdf/1801.07114.pdf</a></li><li>Iain Dunning and Joey Huchette and Miles Lubin. JuMP: A Modeling Language for Mathematical Optimization, <em>SIAM Review</em>, 59 (2017), pp. 295-320.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../McCormick/implicit/">« Relaxation of Implicit Functions</a><a class="docs-footer-nextpage" href="../optimizer/">EAGO Optimizer »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 21 September 2021 18:00">Tuesday 21 September 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
