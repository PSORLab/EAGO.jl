<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Standard-Use Example 1 · EAGO.jl</title><meta name="title" content="Standard-Use Example 1 · EAGO.jl"/><meta property="og:title" content="Standard-Use Example 1 · EAGO.jl"/><meta property="twitter:title" content="Standard-Use Example 1 · EAGO.jl"/><meta name="description" content="Documentation for EAGO.jl."/><meta property="og:description" content="Documentation for EAGO.jl."/><meta property="twitter:description" content="Documentation for EAGO.jl."/><meta property="og:url" content="https://PSORLab.github.io/EAGO.jl/stable/examples/explicit_ann/"/><meta property="twitter:url" content="https://PSORLab.github.io/EAGO.jl/stable/examples/explicit_ann/"/><link rel="canonical" href="https://PSORLab.github.io/EAGO.jl/stable/examples/explicit_ann/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="EAGO.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">EAGO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Optimizer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../optimizer/optimizer/">EAGO Optimizer</a></li><li><a class="tocitem" href="../../optimizer/bnb_back/">EAGO&#39;s Branch and Bound Routine</a></li><li><a class="tocitem" href="../../optimizer/relax_back/">Nonlinear Backend</a></li><li><a class="tocitem" href="../../optimizer/domain_reduction/">Domain Reduction</a></li><li><a class="tocitem" href="../../optimizer/high_performance/">High-Performance Configuration</a></li><li><a class="tocitem" href="../../optimizer/udf_utilities/">User-Defined Functions and Directed Acyclic Graph Utilities</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">McCormick.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../mccormick/overview/">Overview</a></li><li><a class="tocitem" href="../../mccormick/usage/">Basic Usage</a></li><li><a class="tocitem" href="../../mccormick/operators/">Currently Supported Operators</a></li><li><a class="tocitem" href="../../mccormick/type/">Types</a></li><li><a class="tocitem" href="../../mccormick/implicit/">Relaxation of Implicit Functions</a></li></ul></li><li><a class="tocitem" href="../../semiinfinite/semiinfinite/">Semi-Infinite Programming</a></li></ul></li><li><a class="tocitem" href="../../custom_guidelines/">Customization</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Standard-Use Example 1</a><ul class="internal"><li><a class="tocitem" href="#Input-Parameters"><span>Input Parameters</span></a></li><li><a class="tocitem" href="#Construct-the-JuMP-Model-and-Optimize"><span>Construct the JuMP Model and Optimize</span></a></li><li><a class="tocitem" href="#Retrieve-Results"><span>Retrieve Results</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../interval_bb/">Standard-Use Example 2</a></li><li><a class="tocitem" href="../quasiconvex/">Advanced-Use Example 1</a></li><li><a class="tocitem" href="../alpha_bb/">Advanced-Use Example 2</a></li><li><a class="tocitem" href="../modelingtoolkit/">ModelingToolkit Example</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../dev/api_types/">Types</a></li><li><a class="tocitem" href="../../dev/api_functions/">Functions</a></li></ul></li><li><a class="tocitem" href="../../dev/contributing/">Contributing</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../cite/">Citing EAGO</a></li><li><a class="tocitem" href="../../ref/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Standard-Use Example 1</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Standard-Use Example 1</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PSORLab/EAGO.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PSORLab/EAGO.jl/blob/master/docs/src/examples/explicit_ann.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Standard-Use-Example-1"><a class="docs-heading-anchor" href="#Standard-Use-Example-1">Standard-Use Example 1</a><a id="Standard-Use-Example-1-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-Use-Example-1" title="Permalink"></a></h1><p>This example is also provided <a href="https://github.com/PSORLab/EAGO-notebooks/blob/master/notebooks/nlpopt_explicit_ann.ipynb">here as a Jupyter Notebook</a>.</p><h3 id="Solving-an-ANN-to-Optimality-in-EAGO"><a class="docs-heading-anchor" href="#Solving-an-ANN-to-Optimality-in-EAGO">Solving an ANN to Optimality in EAGO</a><a id="Solving-an-ANN-to-Optimality-in-EAGO-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-an-ANN-to-Optimality-in-EAGO" title="Permalink"></a></h3><p>In [<a href="#References">1</a>, <a href="#References">2</a>], a surrogate artificial neural network (ANN) model of bioreactor productivity was constructed by fitting results from computationally expensive computational fluid dynamics (CFD) simulations. The authors then optimized this surrogate model to obtain ideal processing conditions. The optimization problem is given by:</p><p class="math-container">\[\begin{aligned}
\max_{\mathbf x \in X} B_{2} + \sum_{r = 1}^{3} W_{2,r} \frac{2}{1 + \exp (-2y_{r} + B_{1,r})} \; \; {\rm where} \; \; y_{r} = \sum_{i = 1}^{8} W_{1,ir} x_{i}
\end{aligned}\]</p><h2 id="Input-Parameters"><a class="docs-heading-anchor" href="#Input-Parameters">Input Parameters</a><a id="Input-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Input-Parameters" title="Permalink"></a></h2><p>In the first block, we input parameters values supplied in the paper for <span>$W_1$</span>, <span>$W_2$</span>, <span>$B_1$</span>, and <span>$B_2$</span> into Julia as simple array objects. We also input bounds for the variables which are used to scale the values obtained from optimization from <span>$[-1, 1]$</span> back into the design values.</p><pre><code class="language-julia hljs">using JuMP, EAGO

# Weights associated with the hidden layer
W1 = [0.54, -1.97, 0.09, -2.14, 1.01, -0.58, 0.45, 0.26;
      -0.81, -0.74, 0.63, -1.60, -0.56, -1.05, 1.23, 0.93;
      -0.11, -0.38, -1.19, 0.43, 1.21, 2.78, -0.06, 0.40]

# Weights associated with the output layer
W2 = [-0.91, 0.11, 0.52]

# Bias associated with the hidden layer
B1 = [-2.698, 0.012, 2.926]

# Bias associated with the output layer
B2 = -0.46

# Variable bounds (Used to scale variables after optimization)
xLBD = [0.623, 0.093, 0.259, 6.56, 1114.0, 0.013, 0.127, 0.004]
xUBD = [5.89, 0.5, 1.0, 90.0, 25000.0, 0.149, 0.889, 0.049]</code></pre><h2 id="Construct-the-JuMP-Model-and-Optimize"><a class="docs-heading-anchor" href="#Construct-the-JuMP-Model-and-Optimize">Construct the JuMP Model and Optimize</a><a id="Construct-the-JuMP-Model-and-Optimize-1"></a><a class="docs-heading-anchor-permalink" href="#Construct-the-JuMP-Model-and-Optimize" title="Permalink"></a></h2><p>We now formulate the problem using standard JuMP [<a href="#References">3</a>] syntax and optimize it. Note that we are using the <a href="https://jump.dev/JuMP.jl/stable/api/JuMP/#JuMP.@NLexpression"><code>@NLexpression</code></a> macro to handle the summation term to keep the code visually simple, but this could be placed directly in the <a href="https://jump.dev/JuMP.jl/stable/api/JuMP/#JuMP.@NLobjective"><code>@NLobjective</code></a> macro instead.</p><pre><code class="language-julia hljs"># Model construction
model = Model(optimizer_with_attributes(EAGO.Optimizer, &quot;absolute_tolerance&quot; =&gt; 0.001))
@variable(model, -1.0 &lt;= x[i=1:8] &lt;= 1.0)
@NLexpression(model, y[r=1:3], sum(W1[r,i]*x[i] for i in 1:8))
@NLobjective(model, Max, B2 + sum(W2[r]*(2.0/(1 + exp(-2.0*y[r] + B1[r]))) for r=1:3))

# Solve the model
optimize!(model)</code></pre><h2 id="Retrieve-Results"><a class="docs-heading-anchor" href="#Retrieve-Results">Retrieve Results</a><a id="Retrieve-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Retrieve-Results" title="Permalink"></a></h2><p>We then recover the objective value, the solution values, and termination status codes using standard JuMP syntax. The optimal value and solution values are then rescaled using the variable bounds to obtain their physical interpretations.</p><pre><code class="language-julia hljs"># Access calculated values
fval = JuMP.objective_value(model)
xsol = JuMP.value.(x)
status_term = JuMP.termination_status(model)
status_prim = JuMP.primal_status(model)
println(&quot;EAGO terminated with a status of $status_term and a result code of $status_prim.&quot;)
println(&quot;The optimal value is: $(round(fval, digits=5)).&quot;)
println(&quot;The solution found is $(round.(xsol, digits=3)).&quot;)
println(&quot; &quot;)

# Rescale values back to physical space
rescaled_fval = ((fval + 1.0)/2.0)*0.07
rescaled_xsol = ((xsol .+ 1.0)./2.0).*(xUBD - xLBD) .+ xLBD
println(&quot;Rescaled optimal value and solution values:&quot;)
println(&quot;The rescaled optimal value is: $(round(rescaled_fval, digits=4))&quot;)
println(&quot;The rescaled solution is $(round.(rescaled_xsol, digits=3)).&quot;)</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ol><li>J. D. Smith, A. A. Neto, S. Cremaschi, and D. W. Crunkleton, CFD-based optimization of a flooded bed algae bioreactor, <em>Industrial &amp; Engineering Chemistry Research</em>, 52 (2012), pp. 7181–7188.</li><li>A. M. Schweidtmann and A. Mitsos. Global Deterministic Optimization with Artificial Neural Networks Embedded <a href="https://arxiv.org/pdf/1801.07114.pdf">https://arxiv.org/pdf/1801.07114.pdf</a>.</li><li>Iain Dunning and Joey Huchette and Miles Lubin. JuMP: A Modeling Language for Mathematical Optimization, <em>SIAM Review</em>, 59 (2017), pp. 295-320.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../custom_guidelines/">« Customization</a><a class="docs-footer-nextpage" href="../interval_bb/">Standard-Use Example 2 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 22 November 2024 21:41">Friday 22 November 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
